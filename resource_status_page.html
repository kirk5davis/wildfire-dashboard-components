<!doctype html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Resource Status - Dashboard Component</title>
    <meta name="description" content="Wildfire Intel Dashboard Component - Resource Status">
    <meta name="author" content="SitePoint">

    <link rel="stylesheet"
        href="https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/css/calcite-web.min.css">
    <style>
        hr {
            padding: 0px;
            margin: 0px;
        }

        #grid-container {
            min-height: 100%;
        }

        h5 {
            margin-top: 10px;
            font-weight: bold;
        }

        #hidden {
            display: none;
        }

        th {
            font-weight: bold;
        }
    </style>

</head>

<body>
    <div class="grid-container leader-0">
        <div class='column-24'>
            <h5><i class="icon-ui-table"></i>Ground Resources<i class="fa-solid fa-clipboard"></i></h5>
            <div class="loader is-active">
                <div class="loader-bars"></div>
            </div>
            <div class="overflow-auto">
                <table class="table table-striped trailer-0">
                    <thead>
                        <tr class="font-size--3">
                            <th class="text-center" rowspan="2">Region</th>
                            <th class="text-center" colspan="2" scope="colgroup">Available in Region</th>
                            <th class="text-center" colspan="2" scope="colgroup">Available out of Region</th>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="col">Engines</th>
                            <th scope="col">Crews</th>
                            <th scope="col">Engines</th>
                            <th scope="col">Crews</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Northeast</strong></th>
                            <td class="text-center" id="ne_engines_in_region">---</td>
                            <td class="text-center" id="ne_crews_in_region">---</td>
                            <td class="text-center" id="ne_engines_out_region">---</td>
                            <td class="text-center" id="ne_crews_out_region">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Southeast</strong></th>
                            <td class="text-center" id="se_engines_in_region">---</td>
                            <td class="text-center" id="se_crews_in_region">---</td>
                            <td class="text-center" id="se_engines_out_region">---</td>
                            <td class="text-center" id="se_crews_out_region">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Northwest</strong></th>
                            <td class="text-center" id="nw_engines_in_region">---</td>
                            <td class="text-center" id="nw_crews_in_region">---</td>
                            <td class="text-center" id="nw_engines_out_region">---</td>
                            <td class="text-center" id="nw_crews_out_region">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Olympic</strong></th>
                            <td class="text-center" id="oly_engines_in_region">---</td>
                            <td class="text-center" id="oly_crews_in_region">---</td>
                            <td class="text-center" id="oly_engines_out_region">---</td>
                            <td class="text-center" id="oly_crews_out_region">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>South Puget</strong></th>
                            <td class="text-center" id="sps_engines_in_region">---</td>
                            <td class="text-center" id="sps_crews_in_region">---</td>
                            <td class="text-center" id="sps_engines_out_region">---</td>
                            <td class="text-center" id="sps_crews_out_region">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Pacific Cascade</strong></th>
                            <td class="text-center" id="pc_engines_in_region">---</td>
                            <td class="text-center" id="pc_crews_in_region">---</td>
                            <td class="text-center" id="pc_engines_out_region">---</td>
                            <td class="text-center" id="pc_crews_out_region">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Totals</strong></th>
                            <td class="text-center" id="total_engines_in_region">---</td>
                            <td class="text-center" id="total_crews_in_region">---</td>
                            <td class="text-center" id="total_engines_out_region">---</td>
                            <td class="text-center" id="total_crews_out_region">---</td>
                        </tr>
                    </tbody>
                </table>
                <a class="font-size--3" href="https://www.dnr.wa.gov/FightingFire" target="_blank">Learn more about
                    DNR's engines and crews <i class="icon-ui-link-external"></i></a>
            </div>
        </div>
        <div class='column-24 leader-1'>
            <hr>
        </div>
    </div>
    <div class="grid-container leader-0">
        <div class='column-24'>
            <h5><i class="icon-ui-compass"></i>Aviation Resources</h5>
            <div class="loader is-active">
                <div class="loader-bars"></div>
            </div>
            <div class="overflow-auto">
                <table class="table table-striped trailer-0">
                    <thead>
                        <tr class="font-size--3">
                            <th class="text-center">Location</th>
                            <th class="text-center">Rotor</th>
                            <th class="text-center">SEAT</th>
                            <th class="text-center">Air Attack</th>
                            <th class="text-center">LAT</th>
                            <th class="text-center">VLAT</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Westside</strong></th>
                            <td class="text-center" id="westside_helicopters">---</td>
                            <td class="text-center" id="westside_seats">---</td>
                            <td class="text-center" id="westside_air_attack_recon">---</td>
                            <td class="text-center" id="">---</td>
                            <td class="text-center" id="">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Eastside</strong></th>
                            <td class="text-center" id="eastside_helicopters">---</td>
                            <td class="text-center" id="eastside_seats">---</td>
                            <td class="text-center" id="eastside_air_attack_recon">---</td>
                            <td class="text-center" id="">---</td>
                            <td class="text-center" id="">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>In GACC</strong></th>
                            <td class="text-center" id="">---</td>
                            <td class="text-center" id="">---</td>
                            <td class="text-center" id="">---</td>
                            <td class="text-center" id="in_region_lats">---</td>
                            <td class="text-center" id="in_region_vlats">---</td>
                        </tr>
                        <tr class="font-size--3">
                            <th scope="row"><strong>Totals</strong></th>
                            <td class="text-center" id="total_rotors">---</td>
                            <td class="text-center" id="total_seats">---</td>
                            <td class="text-center" id="total_air_attack_recon">---</td>
                            <td class="text-center" id="total_in_region_lats">---</td>
                            <td class="text-center" id="total_in_region_vlats">---</td>
                        </tr>

                    </tbody>
                </table>
                <a class="font-size--3" href="https://www.dnr.wa.gov/Aviation" target="_blank">Learn more about DNR's
                    aviation program <i class="icon-ui-link-external"></i></a>
            </div>
        </div>
    </div>

    <!--JQuery-->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- Moment -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.26.0/moment.min.js"></script>

    <!-- Calcite Web -->
    <script
        src="https://s3-us-west-1.amazonaws.com/patterns.esri.com/files/calcite-web/1.2.5/js/calcite-web.min.js"></script>

    <!-- Build Tables -->
    <script>

        Array.prototype.sum = function (prop) {
            var total = 0
            for (var i = 0, _len = this.length; i < _len; i++) {
                total += this[i]['attributes'][prop]
            }
            return total
        }


        $.getJSON({
            type: "GET",
            async: true,
            url: 'https://services.arcgis.com/4x406oNViizbGo13/ArcGIS/rest/services/survey123_c8dec8f0f7354a99a2e228f118f2eee7_stakeholder/FeatureServer/0/query?where=1%3D1&objectIds=&time=&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&resultType=none&distance=0.0&units=esriSRUnit_Meter&returnGeodetic=false&outFields=*&returnGeometry=false&featureEncoding=esriDefault&multipatchOption=xyFootprint&maxAllowableOffset=&geometryPrecision=&outSR=&datumTransformation=&applyVCSProjection=false&returnIdsOnly=false&returnUniqueIdsOnly=false&returnCountOnly=false&returnExtentOnly=false&returnQueryGeometry=false&returnDistinctValues=false&cacheHint=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&having=&resultOffset=&resultRecordCount=&returnZ=false&returnM=false&returnExceededLimitFeatures=true&quantizationParameters=&sqlFormat=none&f=pjson&token=',
            success: function (results) {
                var region_intel_data = results["features"];
                // gather region objects
                var se_region_obj = region_intel_data.filter(a => a.attributes.region == "SE_Region")[0];
                var ne_region_obj = region_intel_data.filter(a => a.attributes.region == "NE_Region")[0];
                var nw_region_obj = region_intel_data.filter(a => a.attributes.region == "NW_Region")[0];
                var sps_region_obj = region_intel_data.filter(a => a.attributes.region == "SPS_Region")[0];
                var pc_region_obj = region_intel_data.filter(a => a.attributes.region == "PC_Region")[0];
                var oly_region_obj = region_intel_data.filter(a => a.attributes.region == "OLY_Region")[0];

                // set SE Region
                $("#se_engines_in_region").text(se_region_obj["attributes"]["engines_in_region"]);
                $("#se_crews_in_region").text(se_region_obj["attributes"]["crews_in_region"]);
                $("#se_engines_out_region").text(se_region_obj["attributes"]["engines_available_for_out"]);
                $("#se_crews_out_region").text(se_region_obj["attributes"]["crews_available_for_out"]);

                // set NE Region
                $("#ne_engines_in_region").text(ne_region_obj["attributes"]["engines_in_region"]);
                $("#ne_crews_in_region").text(ne_region_obj["attributes"]["crews_in_region"]);
                $("#ne_engines_out_region").text(ne_region_obj["attributes"]["engines_available_for_out"]);
                $("#ne_crews_out_region").text(ne_region_obj["attributes"]["crews_available_for_out"]);

                // set NW Region
                $("#nw_engines_in_region").text(nw_region_obj["attributes"]["engines_in_region"]);
                $("#nw_crews_in_region").text(nw_region_obj["attributes"]["crews_in_region"]);
                $("#nw_engines_out_region").text(nw_region_obj["attributes"]["engines_available_for_out"]);
                $("#nw_crews_out_region").text(nw_region_obj["attributes"]["crews_available_for_out"]);

                // set SPS Region
                $("#sps_engines_in_region").text(sps_region_obj["attributes"]["engines_in_region"]);
                $("#sps_crews_in_region").text(sps_region_obj["attributes"]["crews_in_region"]);
                $("#sps_engines_out_region").text(sps_region_obj["attributes"]["engines_available_for_out"]);
                $("#sps_crews_out_region").text(sps_region_obj["attributes"]["crews_available_for_out"]);

                // set PC Region
                $("#pc_engines_in_region").text(pc_region_obj["attributes"]["engines_in_region"]);
                $("#pc_crews_in_region").text(pc_region_obj["attributes"]["crews_in_region"]);
                $("#pc_engines_out_region").text(pc_region_obj["attributes"]["engines_available_for_out"]);
                $("#pc_crews_out_region").text(pc_region_obj["attributes"]["crews_available_for_out"]);

                // set OLY Region
                $("#oly_engines_in_region").text(oly_region_obj["attributes"]["engines_in_region"]);
                $("#oly_crews_in_region").text(oly_region_obj["attributes"]["crews_in_region"]);
                $("#oly_engines_out_region").text(oly_region_obj["attributes"]["engines_available_for_out"]);
                $("#oly_crews_out_region").text(oly_region_obj["attributes"]["crews_available_for_out"]);

                // set Totals
                $("#total_engines_in_region").text(region_intel_data.sum("engines_in_region"));
                $("#total_crews_in_region").text(region_intel_data.sum("crews_in_region"));
                $("#total_engines_out_region").text(region_intel_data.sum("engines_available_for_out"));
                $("#total_crews_out_region").text(region_intel_data.sum("crews_available_for_out"));

            }
        });
        $.getJSON({
            type: "GET",
            async: true,
            url: 'https://services.arcgis.com/4x406oNViizbGo13/ArcGIS/rest/services/survey123_84d0adc6ab6b4e51abbd0e782e0e5169_stakeholder/FeatureServer/0/query?where=1%3D1&objectIds=&time=&geometry=&geometryType=esriGeometryEnvelope&inSR=&spatialRel=esriSpatialRelIntersects&resultType=none&distance=0.0&units=esriSRUnit_Meter&returnGeodetic=false&outFields=*&returnHiddenFields=false&returnGeometry=false&featureEncoding=esriDefault&multipatchOption=xyFootprint&maxAllowableOffset=&geometryPrecision=&outSR=&datumTransformation=&applyVCSProjection=false&returnIdsOnly=false&returnUniqueIdsOnly=false&returnCountOnly=false&returnExtentOnly=false&returnQueryGeometry=false&returnDistinctValues=false&cacheHint=false&orderByFields=&groupByFieldsForStatistics=&outStatistics=&having=&resultOffset=&resultRecordCount=1&returnZ=false&returnM=false&returnExceededLimitFeatures=true&quantizationParameters=&sqlFormat=none&f=pjson&token=',
            success: function (results) {
                // only returns one record
                var aviation_intel_data = results["features"][0]["attributes"];

                // set Aviation variables
                $("#westside_helicopters").text(aviation_intel_data["westside_helicopters"]);
                $("#westside_seats").text(aviation_intel_data["westside_seats"]);
                $("#westside_air_attack_recon").text(aviation_intel_data["westside_air_attack_recon"]);
                $("#eastside_helicopters").text(aviation_intel_data["eastside_helicopters"]);
                $("#eastside_seats").text(aviation_intel_data["eastside_seats"]);
                $("#eastside_air_attack_recon").text(aviation_intel_data["eastside_air_attack_recon"]);
                $("#in_region_lats").text(aviation_intel_data["in_region_lats"]);
                $("#in_region_vlats").text(aviation_intel_data["in_region_vlats"]);

                // set Aviation Totals
                $("#total_rotors").text(aviation_intel_data["eastside_helicopters"] + aviation_intel_data["westside_helicopters"]);
                $("#total_seats").text(aviation_intel_data["eastside_seats"] + aviation_intel_data["westside_seats"]);
                $("#total_air_attack_recon").text(aviation_intel_data["eastside_air_attack_recon"] + aviation_intel_data["westside_air_attack_recon"]);
                $("#total_in_region_lats").text(aviation_intel_data["in_region_lats"]);
                $("#total_in_region_vlats").text(aviation_intel_data["in_region_vlats"]);
            }
        });

        $('.loader').removeClass("is-active");
    </script>
</body>

</html>